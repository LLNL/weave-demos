#!/usr/bin/env python3

import argparse
from ball_bounce import run_ball_bounce
import os

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument('-i', '--input_deck', help='input deck', type=argparse.FileType('r'))
    args = parser.parse_args()

    print(args.input_deck)

    lines = args.input_deck.readlines()

    args.input_deck.close()

    Inputs = {line.split()[0]: float(line.split()[2]) for line in lines}

    Output = run_ball_bounce(Inputs['x_pos_initial'], Inputs['y_pos_initial'], Inputs['z_pos_initial'],
                                Inputs['x_vel_initial'], Inputs['y_vel_initial'], Inputs['z_vel_initial'], Inputs['gravity'], 100)

    with open('output_deck', 'w') as f:
        f.writelines(lines)
        f.write(('\nnum_bounces = {}' + os.linesep).format(Output[-1]))
